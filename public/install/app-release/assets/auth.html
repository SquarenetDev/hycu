<!DOCTYPE html>
<html>
<head>
    <title>테스트</title>
    <meta name="viewport"
          content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
</head>

<body onload=onLoad()>

<a href="./index.html"><h3>뒤로 가기</h3></a></br>
<center>
    <h3 style="padding:10px;">인증설정 테스트</h3>

    <br>
    <div style="margin:5px;">
        현재 사용자 : <p id=userId>N/A</p>
        현재 비밀번호 : <p id=password>N/A</p>
        현재 인증수단 : <p id=currentType>N/A</p>
    </div>
    <br>

    <br>아이디인증(ID) 설정하기 : <br>
    <button class="button greenBack" onClick="goUrl(this)" id="button1">smartq://hycu?action=setAuth&type=ID</button>
    <br>생체인증(BO) 설정하기 : <br>
    <button class="button blueBack" onClick="goUrl(this)" id="button2">smartq://hycu?action=setAuth&type=BO</button>
    <br>공인인증(CT) 설정하기 : <br>
    <button class="button redBack" onClick="goUrl(this)" id="button3">smartq://hycu?action=setAuth&type=CT</button>
    <br>인증수단 삭제 : <br>
    <button class="button greenBack" onClick="goUrl(this)" id="button4">smartq://hycu?action=deleteAuth</button>
    <br>현재 인증수단 가져오기 : <br>
    <button class="button blueBack" onClick="goUrl(this)" id="button5">smartq://hycu?action=getAuth&returnUrl=https://hycu-b61a9.web.app/result.html</button>
    <br>
    <br>
    <br>
    COPYRIGHT 2020 BY Squarenet. ALL RIGHTS RESERVED.
    <br>

    <br>
</center>

<script type="text/javascript">


function setUserId(userId) {
      var userIdText = document.getElementById("userId")
      userIdText.innerHTML = userId
}

function setPassword(password) {
       var passwordText = document.getElementById("password")
       passwordText.innerHTML = password
}


//Override
function smartQAppCallback(data){

   var response = JSON.parse(data)

    if(response.action == "getUserList"){

        if(response.json.currentSmartQUser){

            var userId = response.json.currentSmartQUser.userId
            var password = response.json.currentSmartQUser.password

            var userIdText = document.getElementById("userId")
            userIdText.innerHTML = userId
            var passwordText = document.getElementById("password")
            passwordText.innerHTML = password


            var button1 = document.getElementById("button1")
            if(button1.innerHTML.indexOf(userId) == -1)
                button1.innerHTML = button1.innerHTML +"&id="+ userId

            var button2 = document.getElementById("button2")
            if(button2.innerHTML.indexOf(userId) == -1)
                button2.innerHTML = button2.innerHTML +"&id="+ userId

            var button3 = document.getElementById("button3")
            if(button3.innerHTML.indexOf(userId) == -1)
                button3.innerHTML = button3.innerHTML +"&id="+ userId

            var button4 = document.getElementById("button4")
            if(button4.innerHTML.indexOf(userId) == -1)
                button4.innerHTML = button4.innerHTML +"&id="+ userId

            var button5 = document.getElementById("button5")
            if(button5.innerHTML.indexOf(userId) == -1)
                button5.innerHTML = button5.innerHTML +"&id="+ userId


            var getAuthScheme = "smartq://hycu?action=getAuth&id=" + userId

             try {
                 webkit.messageHandlers.callbackHandler.postMessage(getAuthScheme);
             } catch(err) {
             }

             try {
                 window.Android.goScheme(getAuthScheme);
             } catch(err) {
             }

        }else{
            var userIdText = document.getElementById("N/A")
            userIdText.innerHTML = userId
            var passwordText = document.getElementById("N/A")
            passwordText.innerHTML = password
        }
    }
    if(response.action == "getAuth"){
        if(response.isSuccess == "Y"){
            var currentType = document.getElementById("currentType")
            currentType.innerHTML = response.type

            //alert(response.errorCode +"\n"+ response.errorMessage+"\n인증종류 : "+ currentType)
        }else{
            var currentType = document.getElementById("currentType")
            currentType.innerHTML = "N/A"

            alert(response.errorCode +"\n"+ response.errorMessage)
        }
    }
    if(response.action == "setAuth"){

        if(response.isSuccess == "Y"){
            var currentType = document.getElementById("currentType")
            currentType.innerHTML = response.type
        }else{
            alert(response.errorCode +"\n"+ response.errorMessage)
        }
    }
    if(response.action == "deleteAuth"){
        if(response.isSuccess == "Y"){
            var currentType = document.getElementById("currentType")
            currentType.innerHTML = "N/A"
        }else{
            alert(response.errorCode +"\n"+ response.errorMessage)
        }
    }
}

function onLoad(){

    var getUserListScheme = "smartq://hycu?action=getUserList"

    try {
        webkit.messageHandlers.callbackHandler.postMessage(getUserListScheme);
    } catch(err) {
    }

    try {
        window.Android.goScheme(getUserListScheme);
    } catch(err) {
    }

}

function goUrl(button){
    //alert(button.innerHTML)
    var url = button.innerHTML.replace(/amp;/gi,"")
    //alert(url)
    window.location.href = url
}
</script>

</body>

<style type="text/css">

    .inputLabel {
        //background-color: #4CAF50; /* Green */
        //border: none;
        //color: white;
        //padding: 15px 32px;
        //text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin : 5px;
        width : 80%;
    }

    .button {
        //background-color: #4CAF50; /* Green */
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin : 5px;
        width : 80%;
    }

    .button a {
        color: white;
    }
    .greenBack {background-color: #4CAF50;} /* Green */
    .blueBack {background-color: #008CBA;} /* Blue */
    .redBack {background-color: #f44336;} /* Red */


</style>
</html>
